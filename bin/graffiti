#!/usr/bin/env ruby

begin
  require "graffiti"
rescue LoadError => e
  $LOAD_PATH.unshift File.dirname(__FILE__) + '/../lib'
  require "graffiti"
end

require 'trollop'

opts = Trollop::options do
  version "#{Graffiti::VERSION}"
  banner <<-EOS
  Graffiti is a local Regular Expressions testing system.
  EOS

  opt :port, "Port to bind to", :default => 8080
end


def symlink_pow?
  pow = ENV['HOME'] + '/.pow'
  puts project_root = File.expand_path(".")

  if File.exists?(pow)
    puts 'Would you like like to symlink pow?'
    input = gets.chomp
    if input == 'yes'
      `ln -s #{project_root} #{pow}/graffiti`
    end
  end

end

symlink_pow?

Graffiti::Server.start("0.0.0.0", opts[:port])
